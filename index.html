<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>3√ó3 Farm Tycoon</title>
<style>
  :root{
    --bg:#0b1020;
    --panel:#0f172a;
    --panel-2:#111827;
    --ink:#e5e7eb;
    --muted:#94a3b8;
    --accent:#22d3ee;
    --good:#34d399;
    --warn:#f59e0b;
    --bad:#ef4444;
    --green:#0a3d1a;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background: radial-gradient(1200px 600px at 70% -20%, #12203a 0%, var(--bg) 50%, #070b16 100%);
    color:var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    display:flex; align-items:center; justify-content:center; padding:8px;
    font-size:14px;
  }
  .app{
    width:min(800px, 100%);
    max-width:800px;
    transform:scale(0.85);   /* shrink entire UI */
    transform-origin:top center;
  }
  .hud{display:flex; flex-wrap:wrap; align-items:center; gap:8px; justify-content:space-between; margin-bottom:10px}
  .brand{display:flex; align-items:center; gap:8px}
  .brand .logo{width:28px; height:28px; border-radius:8px; background:linear-gradient(135deg,#3b82f6,#22d3ee)}
  .brand h1{font-size:16px; margin:0}
  .money{font-weight:700; font-size:16px; padding:6px 10px; border-radius:12px; background:#0b1224; border:1px solid #1f2937}
  .controls{display:flex; gap:6px}
  button{cursor:pointer; color:var(--ink); background:#1f2937; border:1px solid #263244; padding:6px 10px; border-radius:10px; font-weight:600; font-size:13px}
  .danger{border-color:#3b1e1e; background:#2a1616}
  .grid-wrap{background:#0c162a; border:1px solid #1f2a3b; border-radius:14px; padding:12px}
  .grid{display:grid; grid-template-columns:repeat(3,1fr); gap:8px}
  .tile{position:relative; aspect-ratio:1/1; border-radius:12px; background:#0b2a12; border:1px solid #0f3d1a}
  .tile button{position:absolute; inset:0; background:transparent; border:0}
  .soil{position:absolute; inset:0; background:repeating-linear-gradient(180deg,#0e4a22 0 6px,#0b3c1b 6px 12px); opacity:.25}
  .plant{position:absolute; width:56%; height:56%; left:22%; top:22%; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:800; color:#000}
  .plant.ready{outline:2px solid var(--good)}
  .progress{position:absolute; left:6px; right:6px; bottom:6px; height:6px; border-radius:6px; background:#0b1b34}
  .bar{height:100%; width:0%; background:linear-gradient(90deg,#22c55e,#a3e635)}
  .tag{position:absolute; top:6px; left:6px; font-size:10px; padding:3px 6px; border-radius:999px; background:rgba(0,0,0,.3); color:var(--muted)}
  .action{position:absolute; right:6px; top:6px; font-size:10px; padding:3px 6px; border-radius:999px; background:rgba(255,255,255,.1)}

  /* Modal */
  .modal-backdrop{position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:flex-end; justify-content:center}
  .modal{width:min(720px,100%); max-height:80vh; overflow:hidden; background:#0a0f1d; border:1px solid #1f2937; border-top-left-radius:14px; border-top-right-radius:14px; padding:12px}
  .modal h2{margin:4px 6px 6px; font-size:16px}
  .shop{display:grid; gap:8px; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); padding:6px; max-height:60vh; overflow-y:auto}
  .card{padding:8px; border-radius:10px; border:1px solid #263244; background:#121a2e; display:flex; align-items:center; justify-content:space-between; gap:8px; font-size:13px}
  .seed-swatch{width:24px; height:24px; border-radius:6px}
  .card small{display:block; color:var(--muted)}
  .close-row{display:flex; justify-content:flex-end; padding:4px 6px}
  .ghost{background:transparent; border:1px solid #263244}
  .disabled{opacity:.5; pointer-events:none}
  @media (min-width:740px){.modal-backdrop{align-items:center} .modal{border-radius:14px}}
</style>
</head>
<body>
  <div class="app">
    <div class="hud">
      <div class="brand"><div class="logo"></div><h1>3√ó3 Farm Tycoon</h1></div>
      <div class="money" id="money">$0</div>
      <div class="controls">
        <button id="saveBtn">üíæ Save</button>
        <button id="resetBtn" class="danger">‚ôªÔ∏è Reset</button>
      </div>
    </div>
    <div class="grid-wrap"><div class="grid" id="grid"></div></div>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="shopModal">
    <div class="modal">
      <h2>Seed Shop</h2>
      <div class="shop" id="shopList"></div>
      <div class="close-row"><button class="ghost" id="closeShop">Close</button></div>
    </div>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const now = ()=> Date.now();
  const fmtShort = (n)=> n>=1e3 ? `$${(n/1e3).toFixed(1)}K` : `$${Math.floor(n)}`;
  const fmtTime = (ms)=> ms<=0?'0s':(Math.ceil(ms/1000)+'s');

  const SEEDS = [
    { key:'wheat', name:'Wheat', cost:5, grow:10000, yield:10, color:'#b8860b' },
    { key:'apple', name:'Apple', cost:50, grow:60000, yield:80, color:'#ef4444' },
    { key:'blueberry', name:'Blueberry', cost:400, grow:45000, yield:450, color:'#3b82f6' },
    { key:'banana', name:'Banana', cost:1000, grow:60000, yield:1500, color:'#fde047' }
  ];

  const DEFAULT_STATE = { money:100, plots:Array.from({length:9},()=>({state:'empty',seedKey:null,plantedAt:0,readyAt:0})) };
  let state = JSON.parse(localStorage.getItem('farmtycoon_state')||'null')||DEFAULT_STATE;

  const gridEl=$('#grid'), moneyEl=$('#money'), shopModal=$('#shopModal'), shopList=$('#shopList');
  let shopTargetIndex=null;

  function save(){ localStorage.setItem('farmtycoon_state',JSON.stringify(state)); moneyEl.textContent=fmtShort(state.money);}
  function buildGrid(){
    gridEl.innerHTML='';
    state.plots.forEach((p,i)=>{
      const t=document.createElement('div'); t.className='tile';
      t.innerHTML=`<div class="soil"></div><div class="tag"></div><div class="action"></div><div class="plant"></div><div class="progress"><div class="bar"></div></div><button></button>`;
      t.querySelector('button').onclick=()=>onTileClick(i);
      gridEl.appendChild(t);
    });
  }
  function onTileClick(i){
    let p=state.plots[i];
    if(p.state==='empty') openShop(i);
    else if(p.state==='ready'){ harvest(i); }
  }
  function harvest(i){
    const p=state.plots[i]; const s=SEEDS.find(x=>x.key===p.seedKey);
    state.money+=s.yield; state.plots[i]={state:'empty',seedKey:null,plantedAt:0,readyAt:0}; save(); render();
  }
  function plant(i,seed){
    if(state.money<seed.cost) return;
    state.money-=seed.cost;
    const t=now();
    state.plots[i]={state:'growing',seedKey:seed.key,plantedAt:t,readyAt:t+seed.grow};
    save(); closeShop(); render();
  }
  function render(){
    state.plots.forEach((p,i)=>{
      const tile=gridEl.children[i], plant=tile.querySelector('.plant'), tag=tile.querySelector('.tag'), act=tile.querySelector('.action'), bar=tile.querySelector('.bar');
      if(p.state==='empty'){ plant.textContent=''; tag.textContent='Empty'; act.textContent='Plant'; bar.style.width='0%'; }
      else {
        const s=SEEDS.find(x=>x.key===p.seedKey); tag.textContent=s.name;
        if(p.readyAt<=now()){ p.state='ready'; plant.textContent='‚úî'; plant.style.background=s.color; act.textContent='Harvest'; bar.style.width='100%'; }
        else{ const left=p.readyAt-now(); act.textContent=fmtTime(left); plant.style.background=s.color; plant.textContent=''; bar.style.width=(100*(1-left/s.grow))+'%'; }
      }
    });
  }
  function openShop(i){shopTargetIndex=i; buildShop(); shopModal.style.display='flex';}
  function closeShop(){shopModal.style.display='none';}
  $('#closeShop').onclick=closeShop;
  function buildShop(){
    shopList.innerHTML='';
    SEEDS.forEach(s=>{
      const c=document.createElement('div'); c.className='card';
      c.innerHTML=`<div style="display:flex;align-items:center;gap:6px"><div class="seed-swatch" style="background:${s.color}"></div><div><div style="font-weight:800">${s.name}</div><small>Cost:${fmtShort(s.cost)}</small><small>Grow:${fmtTime(s.grow)}</small><small>Yield:${fmtShort(s.yield)}</small></div></div>`;
      const b=document.createElement('button'); b.textContent='Plant'; if(state.money<s.cost) b.classList.add('disabled'); b.onclick=()=>plant(shopTargetIndex,s);
      c.appendChild(b); shopList.appendChild(c);
    });
  }
  $('#saveBtn').onclick=save;
  $('#resetBtn').onclick=()=>{ if(confirm('Reset?')){state=JSON.parse(JSON.stringify(DEFAULT_STATE)); save(); render();}};
  buildGrid(); save(); render(); setInterval(render,500);
})();
</script>
</body>
</html>
